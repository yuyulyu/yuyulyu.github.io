# 中文版
## 建模
若随机变量（X,Y）服从二维正态分布，记为 $$ (X,Y) \sim N(\mu_1, \mu_2; \sigma_1^2, \sigma_2^2; \rho)$$ 其概率密度函数为：$$f(x,y) = \frac{1}{2\pi\sigma_1\sigma_2\sqrt{1-\rho^2}} \exp\left\{ -\frac{1}{2(1-\rho^2)} \left[ \frac{(x-\mu_1)^2}{\sigma_1^2} - 2\rho\frac{(x-\mu_1)(y-\mu_2)}{\sigma_1\sigma_2} + \frac{(y-\mu_2)^2}{\sigma_2^2} \right] \right\}$$
等方差且独立的二维正态分布：
$\rho=0$ 且 $ \sigma_1=\sigma_2=\sigma$，则有概率密度函数
$$f(x,y) = \frac{1}{2\pi\sigma^2} \exp\left\{ -\frac{1}{2\sigma^2} \left[ (x-\mu_1)^2 + (y-\mu_2)^2 \right] \right\}$$


**假设**：当一个物体（如手指或被抓取物体）接触传感器阵列表面时，产生的接触力服从独立等方差二维正态分布。   
共有九个力传感器，当物体表面某一点处受力时，每个传感器都会返回测量到的接触力。   
对于第 $i$ 个传感器（位置 $(x_i, y_i)$），测得的接触力 $Z_i$ 为：
$$Z_i = P_0 \times \exp\left\{-\frac{1}{2\sigma^2} \left[ (x_i - x_c)^2 + (y_i - y_c)^2 \right]\right\}$$
- $P_0$：接触点中心 $(x_c, y_c)$ 处的最大接触力
- $\sigma^2$：描述接触力在空间上扩散程度的参数（待估计）
- $(x_i, y_i)$：第$ i $个传感器的中心坐标（已知）。
- $ (x_c, y_c) $：接触点的中心坐标（待估计）。


## 线性化与变量代换

非线性方程求解困难，需要线性化。

对原方程取自然对数：
$$
\begin{align*}
\ln Z_i &= \ln \left( P_0 \times e^{\frac{-(x_i - x_c)^2 - (y_i - y_c)^2}{2\sigma^2}} \right) \\
&= \ln P_0 - \frac{x_c^2 + y_c^2}{2\sigma^2} + \frac{x_c}{\sigma^2}x_i + \frac{y_c}{\sigma^2}y_i - \frac{1}{2\sigma^2}(x_i^2 + y_i^2)
\end{align*}
$$
引入新系数：
$$
\begin{cases}
b_0 = \ln P_0 - \dfrac{x_c^2 + y_c^2}{2\sigma^2} \\
b_1 = \dfrac{x_c}{\sigma^2} \\
b_2 = \dfrac{y_c}{\sigma^2} \\
b_3 = -\dfrac{1}{2\sigma^2}
\end{cases}
$$

原方程简化为线性形式：
$$\ln Z_i = b_0 + b_1 x_i + b_2 y_i + b_3 (x_i^2 + y_i^2)$$

9个传感器采集到的数据构成线性方程组：
$$
\begin{cases}
\ln Z_1 = b_0 + b_1 x_1 + b_2 y_1 + b_3 (x_1^2 + y_1^2) \\
\ln Z_2 = b_0 + b_1 x_2 + b_2 y_2 + b_3 (x_2^2 + y_2^2) \\
\vdots \\
\ln Z_9 = b_0 + b_1 x_9 + b_2 y_9 + b_3 (x_9^2 + y_9^2)
\end{cases}
$$
矩阵形式：
$$\mathbf{Y} = \mathbf{XX} \cdot \mathbf{B}^T$$

其中：
- 观测向量 $\mathbf{Y} = \begin{bmatrix} \ln Z_1 \\ \ln Z_2 \\ \vdots \\ \ln Z_9 \end{bmatrix}$
- 设计矩阵 $\mathbf{XX} = \begin{bmatrix} 1 & x_1 & y_1 & x_1^2 + y_1^2 \\ 1 & x_2 & y_2 & x_2^2 + y_2^2 \\ \vdots & \vdots & \vdots & \vdots \\ 1 & x_9 & y_9 & x_9^2 + y_9^2 \end{bmatrix}$
- 系数向量 $\mathbf{B} = \begin{bmatrix} b_0 \ b_1 \ b_2 \ b_3 \end{bmatrix}$



## 方程求解
使用最小二乘法求解系数矩阵$\mathbf{B}$（推导过程不作赘述）：
$$\mathbf{B} = (\mathbf{XX}^T\mathbf{XX})^{-1}\mathbf{XX}^T\mathbf{Y}$$
通过系数 $\mathbf{B}$ 反解未知参数：
$$
\begin{align*}
\sigma^2 &= -\frac{1}{2b_3} \\
x_c &= -\frac{b_1}{2b_3} \\
y_c &= -\frac{b_2}{2b_3} \\
P_0 &= \exp\left( b_0 - \frac{b_1^2 + b_2^2}{4b_3} \right)
\end{align*}
$$

## 总结
1. **物理建模**：假设接触力呈二维正态分布 $Z_i = P_0 \times e^{\frac{-(x_i - x_c)^2 - (y_i - y_c)^2}{2\sigma^2}}$
2. **线性化**：取自然对数并展开
3. **变量代换**：定义 $b_0,b_1,b_2,b_3$ 得到线性方程 $\ln Z_i = b_0 + b_1 x_i + b_2 y_i + b_3 (x_i^2 + y_i^2)$
4. **最小二乘估计**：求解 $\mathbf{B} = (\mathbf{XX}^T\mathbf{XX})^{-1}\mathbf{XX}^T\mathbf{Y}$
5. **参数反解**：计算 $\sigma^2, x_c, y_c, P_0$   
最终 $P_0$ 用于控制夹具开合程度（0-1标量）。

# English Version (translated by deepseek)
## Modeling
If a random variable (X, Y) follows a bivariate normal distribution, denoted as $$ (X,Y) \sim N(\mu_1, \mu_2; \sigma_1^2, \sigma_2^2; \rho)$$ its probability density function is:
$$f(x,y) = \frac{1}{2\pi\sigma_1\sigma_2\sqrt{1-\rho^2}} \exp\left\{ -\frac{1}{2(1-\rho^2)} \left[ \frac{(x-\mu_1)^2}{\sigma_1^2} - 2\rho\frac{(x-\mu_1)(y-\mu_2)}{\sigma_1\sigma_2} + \frac{(y-\mu_2)^2}{\sigma_2^2} \right] \right\}$$

For equal variance and independent bivariate normal distribution:
$\rho=0$ and $ \sigma_1=\sigma_2=\sigma$, the probability density function becomes:
$$f(x,y) = \frac{1}{2\pi\sigma^2} \exp\left\{ -\frac{1}{2\sigma^2} \left[ (x-\mu_1)^2 + (y-\mu_2)^2 \right] \right\}$$

**Assumption**: When an object (e.g., finger or grasped object) contacts the sensor array surface, the generated contact forces follow an independent, equal-variance bivariate normal distribution.  
There are nine force sensors. When a point on the object surface is subjected to force, each sensor returns the measured contact force.  
For the $i$-th sensor (position $(x_i, y_i)$), the measured contact force $Z_i$ is:
$$Z_i = P_0 \times \exp\left\{-\frac{1}{2\sigma^2} \left[ (x_i - x_c)^2 + (y_i - y_c)^2 \right]\right\}$$
- $P_0$: Maximum contact force at the contact point center $(x_c, y_c)$
- $\sigma^2$: Parameter describing the spatial diffusion of contact force (to be estimated)
- $(x_i, y_i)$: Center coordinates of the $i$-th sensor (known)
- $(x_c, y_c)$: Center coordinates of the contact point (to be estimated)

## Linearization and Variable Substitution

Nonlinear equations are difficult to solve, requiring linearization.

Take the natural logarithm of the original equation:
$$
\begin{align*}
\ln Z_i &= \ln \left( P_0 \times e^{\frac{-(x_i - x_c)^2 - (y_i - y_c)^2}{2\sigma^2}} \right) \\
&= \ln P_0 - \frac{x_c^2 + y_c^2}{2\sigma^2} + \frac{x_c}{\sigma^2}x_i + \frac{y_c}{\sigma^2}y_i - \frac{1}{2\sigma^2}(x_i^2 + y_i^2)
\end{align*}
$$
Introduce new coefficients:
$$
\begin{cases}
b_0 = \ln P_0 - \dfrac{x_c^2 + y_c^2}{2\sigma^2} \\
b_1 = \dfrac{x_c}{\sigma^2} \\
b_2 = \dfrac{y_c}{\sigma^2} \\
b_3 = -\dfrac{1}{2\sigma^2}
\end{cases}
$$

The original equation simplifies to linear form:
$$\ln Z_i = b_0 + b_1 x_i + b_2 y_i + b_3 (x_i^2 + y_i^2)$$

Data from nine sensors form a system of linear equations:
$$
\begin{cases}
\ln Z_1 = b_0 + b_1 x_1 + b_2 y_1 + b_3 (x_1^2 + y_1^2) \\
\ln Z_2 = b_0 + b_1 x_2 + b_2 y_2 + b_3 (x_2^2 + y_2^2) \\
\vdots \\
\ln Z_9 = b_0 + b_1 x_9 + b_2 y_9 + b_3 (x_9^2 + y_9^2)
\end{cases}
$$
Matrix form:
$$\mathbf{Y} = \mathbf{XX} \cdot \mathbf{B}^T$$

Where:
- Observation vector $\mathbf{Y} = \begin{bmatrix} \ln Z_1 \\ \ln Z_2 \\ \vdots \\ \ln Z_9 \end{bmatrix}$
- Design matrix $\mathbf{XX} = \begin{bmatrix} 1 & x_1 & y_1 & x_1^2 + y_1^2 \\ 1 & x_2 & y_2 & x_2^2 + y_2^2 \\ \vdots & \vdots & \vdots & \vdots \\ 1 & x_9 & y_9 & x_9^2 + y_9^2 \end{bmatrix}$
- Coefficient vector $\mathbf{B} = \begin{bmatrix} b_0 \ b_1 \ b_2 \ b_3 \end{bmatrix}$

## Equation Solving
Solve for coefficient matrix $\mathbf{B}$ using least squares method (derivation omitted):
$$\mathbf{B} = (\mathbf{XX}^T\mathbf{XX})^{-1}\mathbf{XX}^T\mathbf{Y}$$
Solve for unknown parameters using coefficients $\mathbf{B}$:
$$
\begin{align*}
\sigma^2 &= -\frac{1}{2b_3} \\
x_c &= -\frac{b_1}{2b_3} \\
y_c &= -\frac{b_2}{2b_3} \\
P_0 &= \exp\left( b_0 - \frac{b_1^2 + b_2^2}{4b_3} \right)
\end{align*}
$$

## Summary
1. **Physical modeling**: Assume contact forces follow bivariate normal distribution $Z_i = P_0 \times e^{\frac{-(x_i - x_c)^2 - (y_i - y_c)^2}{2\sigma^2}}$
2. **Linearization**: Take natural logarithm and expand
3. **Variable substitution**: Define $b_0,b_1,b_2,b_3$ to obtain linear equation $\ln Z_i = b_0 + b_1 x_i + b_2 y_i + b_3 (x_i^2 + y_i^2)$
4. **Least squares estimation**: Solve $\mathbf{B} = (\mathbf{XX}^T\mathbf{XX})^{-1}\mathbf{XX}^T\mathbf{Y}$
5. **Parameter solution**: Compute $\sigma^2, x_c, y_c, P_0$  
Final $P_0$ is used to control gripper opening percentage (0-1 scalar).
